<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</head>
<body>
<div >
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Price</th>
            <th scope="col">Quantity</th>
        </tr>
        </thead>
        <tbody id="display">
        </tbody>
    </table>
</div>
<div>
    <input type="text" id="name">
    <input type="text" id="price">
    <input type="text" id="quantity">
    <button onclick="save()">Save</button>
</div>
<script>
    loadDataByGet()
    function loadData() {
        $.ajax({
            type: "GET", // Loạt phương thức
            url:"http://localhost:8080/products", // đường dẫn đến BE
            success: function (x) { // nếu thành công (không xảy ra lỗi từ BE) thì sẽ gọi hàm, x-dữ liệu mà hàm ở BE gửi đi
                let str = "";
                for (let i=0; i < x.data.length; i++) {
                    str += `<tr>
                            <td>${x.data[i].name}</td>
                            <td>${x.data[i].price}</td>
                            <td>${x.data[i].quantity}</td>
                        </tr>`
                }
                document.getElementById('display').innerHTML = str;
            }, error: console.log("lỗi") // nếu backend có lỗi
        })
    }
    // Mô tả các phần bên trong của ajax(): get / post
    function save() {
        let name = document.getElementById('name').value;
        let price = document.getElementById('price').value;
        let quantity = document.getElementById('quantity').value;
        let product = {
            name: name,
            price: price,
            quantity: quantity
        }
        $.ajax({
            headers: { // quy định kiểu dữ liệu gửi ajax (html, fe) -> java (be)
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            type: "Post",
            url: "http://localhost:8080/products",
            data: JSON.stringify(product), // dữ liệu nhập từ html để gửi cho be
            success: function (x) {
                loadData();
                document.getElementById('name').value = "";
                document.getElementById('price').value = "";
                document.getElementById('quantity').value = "";
            }
        })
    }


</script>
</body>
</html>
